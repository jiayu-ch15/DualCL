import torch
import tensordict

def _norm(x):
    y = x / (torch.norm(x, dim=-1, keepdim=True)).expand_as(x)
    return y

a = torch.tensor([[1,2,3], [4,5,6]])*1.0
print(_norm(a))
# b = tensordict({
#     "w":
#         {
#             "r": 2
#         }

# })
# print(b['w'])